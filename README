Nabiki - A Comprehensive Trading Platform for Chinese Future Market
===================================================================

Requisites
----------

1. JDK 11+
2. nabiki_chart4j, nabiki_ctp4j
3. Other opensource 3rds

Communication Protocol between Server and Client
------------------------------------------------

Nabiki turns data to JSON and encodes into frame with the following format:

    <frame type> -- <length> -- <payload in bytes>

The frame type defines the types of the frame, which could be a request, response,
login or heartbeat.

JSON is defined by `com.nabiki.iop.frame.Body` and generated with Gson. The class
has a field `message type` which describes the purpose of the data.

For each request message, it has a request ID, so does a response message. One
request or response can have many fractions that share the same ID.

`total count` tells how many pieces of fraction there are and `current count` tells
the number of current message.

The data is encoded as a JSON string and needs to be decoded one more time.

Dependency Explanation
----------------------

1. Gson is for parsing and generating JSON.
2. Apache Mina is for networking.
3. SLF4J is required by Apache Mina.
4. Nabiki_chart4j is for plotting charts with market data received by client.
5. Nabiki_ctp4j is for communication with broker's counter.

For modules above,centre depends on iop and objects, and iop depends on objects,
Gson and Apache Mina.

Module Explanation
------------------

1. /objects

The module contains pure Java classes for CTP data. Although ctp4j has the data
definition, they are backed by JNI, which means for each data instance in Java, there
is a C/C++ counterpart in JNI that holds the actual data. Upon accessing the fields,
it calls JNI.

Wrapping the data in pure Java saves frequent JNI calls.

2. /iop

The module handles networking and frame/message codec.

3. /centre

Core system that processes trades, receives ticks and generates candles, and manages
user account and positions.

Make it Work
------------

1. Acquire dependencies.

All dependencies are kept within /lib and /lib2. /lib has 3rd deps and /lib2 has
nabiki_* like deps.

ctp4j only has 64-bit windows JNI binding. If you need other choices, please go to
https://github.com/chenhongbao/nabiki_chart4j for your version.

2. Configuration

`center` will create dirs for you and generates sample configs for you if it doesn't
find configuration in dirs. Just follow the sample configs to add your own setting.

But it will not generate samples for user account and position, so you need to add
an initial account with no position before you trade.

Please go to https://github.com/chenhongbao/nabiki_install for a reference install
setup.

3. Setting JNI Right

Use `-Djava.library.path=<path-to-dll>` to specify JNI DLLs. Please add the option
before `-jar centre.jar` so JVM recognizes it.

There are 3 DLLs, don't miss any one of them.

Reference
---------

1. chart4j: https://github.com/chenhongbao/nabiki_chart4j
2. ctp4j:   https://github.com/chenhongbao/nabiki_ctp4j
3. install: https://github.com/chenhongbao/nabiki_install


Good luck with trades.

Hongbao Chen
chenhongbao@outlook.com
